package com.verizon.tms.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import com.verizon.tms.dao.TicketRepository;
import com.verizon.tms.model.Ticket;

@RestController
@RequestMapping(value="/")
public class TicketController {

	@Autowired
	TicketRepository tr;
	Ticket t;
	
	@RequestMapping(value="/getall",method=RequestMethod.GET)
	public List<Ticket> getAllTickets(){
		return tr.getAllTickets();
	}
	
	@RequestMapping(value="/gettkt/{id}",method=RequestMethod.GET)
	public Ticket getTicketById(@PathVariable("id") int id) {
		return tr.getTicketById(id);
	}
	
	@RequestMapping(value="/create",method=RequestMethod.POST)
	public Ticket addTicket(@RequestBody Ticket tt) {
		return tr.addTicket(tt);
	}
	
	@RequestMapping(value="/delete/{id}",method=RequestMethod.DELETE)
	public void deleteTicket(@PathVariable("id") int id) {
		t=tr.getTicketById(id);
		tr.deleteTicket(t);
	}
	
	@RequestMapping(value="/update/{id}",method=RequestMethod.PUT)
	public Ticket updateTicket(@PathVariable("id") int id,@RequestBody Ticket ut) {
		t=tr.getTicketById(id);
		if(ut.getDescription()!=null) {
			t.setDescription(ut.getDescription());
		}
		if(ut.getStatus()!=null) {
			t.setStatus(ut.getStatus());
		}
		tr.updateTicket(t);
		return t;
	}
}
